import {AfterViewInit, Component, ElementRef, Input, ViewChild} from '@angular/core';
import {AvmuService, RadarData} from '../avmu.service';
import * as d3 from 'd3';
import {WebsocketService} from '../websocket.service';

@Component({
	selector: 'app-avmu',
	templateUrl: './avmu.component.html',
	styleUrls: ['./avmu.component.css'],
	providers: [AvmuService, WebsocketService]
})
export class AvmuComponent implements AfterViewInit {
	@ViewChild('radarData') public canvas: ElementRef;

	@Input() public width = 1;
	@Input() public height = 2048;

	ctx: CanvasRenderingContext2D;
	radarData: RadarData;

	constructor(private avmuService: AvmuService) {
		this.radarData = {
			magnitude: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.942243542145693, 0.8961454621890683, 0.8518443613682499, 1.1839140308763207, 1.3949744963154735, 1.5707776402061513, 2.050750735953452, 3.129905067634767, 4.3518836850342515, 5.943246985720903, 7.564659365158067, 11.098287497601065, 15.007732472041116, 17.47796883081795, 34.546915707538744, 64.59540284709338, 60.10465326290068, 61.76275119716929, 56.584666292386146, 43.725007116906255, 25.699843734583872, 20.541071191990973, 19.962738866507028, 16.639151312273388, 19.40320215080319, 0.4198687542875525, 0.3604029888384023, 0.392130045255261, 0.25457305417567255, 0.14602512449904456, 0.07402887363884801, 0.22515924296938025, 0.12030126033437093, 0.12194570613379471, 0.24720539598693625, 0.31691652343630694, 0.05677573224567922, 0.08136486073582551, 0.05829720118434345, 0.2129669666828827, 0.18923472997163773, 0.2571965522059249, 0.06140801438261789, 0.3982736839481062, 0.49202597233420103, 0.1426627760379531, 0.2889433323766754, 0.20688998149874485, 0.09368419332027793, 0.42946275109582666, 0.38411520459518905, 0.3437007097905109, 0.22004201235609544, 0.09960642201620337, 0.14257418583278536, 0.14429509333985324, 0.2308897211964362, 0.47309917447799027, 0.22429008118321292, 0.07564679059327517, 0.10823820718812772, 0.17314075830241227, 0.5015668651054909, 0.39619010309807834, 0.17922132046909775, 0.08106815605695772, 0.1639837110886475, 0.41460654693699034, 0.5369436970809957, 1.6133820490294897, 1.5457753796994769, 1.058267528738102, 1.0842308164048766, 0.7926308705953649, 0.4006520821859937, 0.20250720397581382, 0.9902123003423084, 0.7460174799015635, 0.6613197289115754, 0.9357310909446254, 0.3444282892290794, 0.8900275796918834, 0.975525855360523, 0.6970222775368828, 0.7251047005768324, 0.636461784490446, 0.5475193474598765, 0.7822604022299925, 1.0376553524405665, 0.5241046007961309, 0.47351856683103766, 0.9684614723169148, 0.6570663101200758, 0.5454951752210206, 0.4542947738348135, 0.22254384534839744, 0.25125978764250106, 0.4678375327511658, 0.3623127101055795, 0.5173590223791638, 0.4955498676754446, 0.5273767086427154, 0.49086958781492207, 0.7695738819302487, 0.5425893312227857, 0.3464019786204905, 0.0, 0.5293880312800562, 0.39825522426906507, 0.0, 0.6413927388263019, 1.0675240249633073, 0.41311831129279497, 0.9506256957470117, 1.4692764667091698, 0.9395497534173529, 1.3337924606172502, 1.509195746305045, 1.874983754799083, 1.6746515613514297, 1.7353932802506016, 1.9864611400934669, 5.667649133072933, 6.792833498524046, 4.067133464116182, 3.275995073344012, 0.9912332186460161, 1.0431880063220973, 2.3763652702507954, 1.5824094648053777, 1.2969348928925464, 0.6892823999466943, 0.640797732412948, 0.8864820454518416, 0.3533154482524186, 0.22529917283123588, 0.16061864671926074, 0.5120729041432199, 0.32649924214139414, 0.8391582605690056, 0.5981617062354246, 1.057673070239744, 0.3371404296233656, 0.6126280118559728, 0.6174847068281762, 0.6904448149799656, 0.5219030774566633, 1.0223342885810691, 0.24988411446937586, 0.3561305381403628, 0.4012409512958746, 1.02287319199236, 1.2222645644546262, 0.9179664153379292, 0.9249331638027604, 0.7907623093609162, 0.7967116928234805, 1.0188379230386235, 1.143627307776228, 1.3979267929552732, 1.2976336689313364, 1.7429157189038502, 1.8097252803432131, 1.544280611455882, 1.1266286122348046, 1.5667569362993163, 1.628961436050083, 0.5755765452686429, 1.7630496257202688, 2.3077084271325057, 2.1198570657902764, 1.7262159680071136, 1.9435142986605232, 1.4239968666978051, 0.8813302718705702, 2.130716747504894, 0.6129756015824647, 1.0910403807771516, 1.183122215472481, 2.382355737123072, 3.521128677565256, 2.6145860579120046, 2.890442776593052, 2.745460913733956, 0.9430770003628706, 1.0296960940247168, 1.1588387645290368, 0.933167403737059, 2.3481930123136547, 3.847500296429056, 3.8357658697226262, 4.542701106458166, 4.584611543608943, 6.999129042099691, 6.3359629709549345, 6.599339157966816, 6.65025548105181, 6.914870701619327, 7.466253079569224, 7.055764518912192, 7.167108701988382, 6.129723846785577, 7.653115567883132, 8.552617384327, 11.417125473321292, 14.651515670985505, 18.030925604566225, 22.89518384696102, 22.27184711465604, 24.298416549168795, 24.513904893090224, 23.061001734341193, 23.192078962439247, 24.732208820155794, 26.00498054504701, 29.022960092972404, 31.767615620483255, 37.33265115929431, 42.44768099253289, 56.31858823210446, 42.50624667645753, 66.9656023814905, 71.70335111532924, 80.49517017242411, 89.62016907897672, 97.7492872013667, 111.33160267239697, 120.86746884260688, 129.93798200639208, 80.66637048528241, 8.77806741952334, 8.789053013586402, 8.044386906067581, 6.1267257267145965, 5.923939640210022, 4.153811684382643, 5.180130769249101, 4.197753274050989, 3.516454809688178, 0.6323230266387725, 6.2680490950718, 6.077851854919928, 6.8264192358860765, 5.253688232713507, 5.128834923869451, 2.482903463296027, 2.621336273953716, 0.329313460922549, 3.326111092750354, 6.458076639581791, 9.080443457660351, 12.626594863116315, 14.495121727799825, 16.990570641221215, 15.936353266582806, 13.785345230075709, 12.064863469684324, 11.135565212115186, 10.70341889759946, 12.193433046234777, 12.296141499902076, 9.03259651224528, 7.601645544046788, 8.683558703776585, 10.46098906301213, 6.9052786020304335, 2.746519293813786, 1.8114122779957142, 2.2136918434600386, 2.1316462735485495, 1.03865293596162, 3.8510478160288697, 9.446109793418323, 23.109254790568674, 55.84520126598727, 74.46244566419827, 92.69827890325922, 108.13088753252563, 130.87333443711375, 157.13432144308902, 171.11389976644233, 52.53301010690033, 50.17590147700065, 29.75131507374976, 25.29938058764879, 29.393475364245933, 42.995951145943515, 54.26094476525896, 69.7311030345981, 71.48681442249901, 62.39927802376015, 54.227116033851416, 48.012122342272114, 42.7355325203011, 42.142702921623425, 22.757970479532812, 11.53341745108693, 34.3738023549668, 44.91439117638397, 45.86069006686669, 48.447545404826286, 59.969720487039204, 75.676381150532, 81.66539178065709, 90.79354009802805, 109.20079353186385, 118.93200672459591, 123.4633623514755, 127.25434959727865, 132.26108698227407, 132.979721051659, 123.04493908443649, 99.19995151054049, 85.741650694713, 72.99919581158191, 65.3780637931798, 60.308766445397936, 51.02713589563065, 41.342053822348646, 40.32183714766717, 40.299855247077694, 40.14802324462785, 41.341116733173024, 40.61549498692651, 38.79830663982988, 39.26973551959493, 43.105523470397664, 27.813403669888825, 48.596308033730864, 79.77476080838072, 85.35247153805996, 94.80057927254214, 97.09928667804644, 90.628620440503, 11.748747564216771, 5.500392969284456, 9.2975171188685, 11.859539876674008, 11.55079263928253, 14.695763615996226, 13.84838612763457, 12.4553011476758, 17.39805441961921, 17.026422613356267, 16.933085190107377, 10.624686421201133, 5.686944516795167, 1.7569411484292545, 10.927708179780993, 13.652909943469448, 15.386839465305806, 15.726933381908482, 20.017858750139453, 23.302855818653555, 26.12365568826386, 23.042270840797105, 20.80726554908176, 19.64885267224769, 21.662046518253494, 23.075124603071483, 22.161922824908295, 27.940645748626146, 24.93498786267615, 20.729918090536966, 17.723824626463255, 17.614051744190423, 14.40648192726573, 11.562290055838558, 4.437203118219848, 3.9381719338407954, 2.5919693651294664, 6.4280127069852275, 14.152146658806545, 17.739940512162224, 12.950068846216224, 13.160148989420122, 11.53557252005849, 9.22253868240988, 14.918807944221976, 192.37169792414747, 246.6661966525013, 291.94075695546036, 347.3059179118956, 407.82861222260874, 460.8200642182936, 506.1651408068427, 184.12144693383937, 243.92395560315413, 244.6801067498481, 275.28547843888487, 303.08777866872015, 345.1046100993661, 397.8064953247414, 437.05759382359736, 485.93644743277923, 537.1151399193913, 581.2748038652435, 627.3451053612188, 675.9874611311077, 723.240396031818, 762.1564228693716, 775.2253286883002, 775.2907557912087, 774.1961011492028, 796.8543700540779, 805.7454164039472, 810.078871999224, 817.013080595713, 808.4853721421202, 786.024776705198, 765.3050112614885, 736.9080473329964, 714.31125605565, 699.1440337071639, 678.0069889460171, 612.2039481071839, 580.9268481203779, 540.4609521754404, 518.5432756513857, 502.7705503843668, 478.8230051556461, 450.44056761791506, 460.9223183214932, 454.7241809667568, 547.3293680770561, 512.6513990900193, 476.25402590795704, 455.5071395344466, 445.059092475629, 416.1937892058594, 374.63463330528333, 335.50041881980724, 326.5800078904861, 35.71373250868992, 26.520515591676713, 17.087188860521717, 12.963944631601912, 10.462017049910958, 3.7210607861608125, 2.3563520801342293, 6.269823052103381, 9.466968895623607, 11.824837163367215, 11.853609262198253, 8.889460303257676, 10.496741230944211, 12.586244225327203, 10.265125365363842, 19.52710611912221, 20.993543733445502, 23.840366388031754, 18.66641205677081, 13.865971482660553, 9.667574316218495, 13.983829613621857, 15.772627123460325, 15.277564360529578, 18.7768201882086, 21.687729118943455, 21.798948189480214, 19.731231807364498, 19.831073036110862, 18.152132448157136, 14.354593561984036, 12.148235769202106, 7.283748223624877, 5.448216694144094, 2.184323839826472, 8.61682098682861, 8.515753623139986, 5.979804508243654, 4.075783229634754, 6.797607585268729, 1.3604259592131744, 5.775539425750425, 13.079637807885131, 14.641975928515336, 59.21224940569042, 58.0912360848212, 61.75660166637258, 63.96006599851831, 71.93792691684831, 82.79886895037491, 84.74326875094928, 80.80963367586547, 16.18095679656521, 14.819950422963203, 12.396965497335572, 30.882032472399406, 46.20292460311716, 60.52138529116673, 60.34348540633269, 62.6934168403652, 71.76199468373879, 71.73136186567444, 81.26200397066235, 84.5331770672961, 83.47420559129213, 84.54806498619601, 93.00983799043394, 89.37416287928112, 82.87133044700929, 85.27690693755648, 80.20153389367259, 84.23453057797946, 83.77269255107497, 81.62732743626322, 76.54583384281281, 66.7458896388832, 68.07532014638309, 76.6814180805636, 72.69541735356744, 61.24832867015514, 43.84844047226718, 30.21392771946109, 40.275851634269856, 53.999730012197816, 45.64015684794689, 36.95967731676021, 32.51705886400147, 33.66423113658527, 35.14105208622788, 32.10330579635271, 37.43560495307553, 48.61353149483877, 57.18487706523131, 68.17952409945237, 77.65180041660331, 81.39441881031614, 74.1237517255504, 50.84184647455262, 66.60515287632357, 67.6216168954564, 51.32475313398036, 36.941562076471705, 55.27680533719586, 100.14471279762537, 75.24358657429296, 29.308542935704377, 35.25201981717815, 37.84792478281756, 34.2704528076007, 28.99507861946261, 29.861505613132977, 30.555117817409382, 27.738802667814628, 21.990877355227255, 21.369173411959867, 25.35972481778643, 16.56102291097783, 18.017299793639847, 23.151817186698427, 32.882475633528365, 45.08116341127877, 57.817167666818804, 55.254461320332766, 62.669687856892345, 59.623863706308825, 51.642219488189774, 33.43907029191177, 27.54218200640863, 30.386311578822067, 34.258362945676474, 43.744595049393595, 41.868876036472095, 46.6136024553869, 41.327869526492904, 26.43427988628088, 19.795398008047385, 13.970994521781291, 27.034526529413803, 45.79744181894796, 58.673868042491996, 64.6527463855277, 60.127583819960456, 48.759657536937205, 33.28406205728408, 27.38119834990973, 18.73397349062891, 0.8381063548695898, 15.435932730849315, 23.08873265570944, 29.229906808539393, 9.727483762936085, 91.38462285049377, 82.57276194267422, 107.9675989369921, 125.00047005532898, 129.6203849644721, 135.2121583121708, 106.07716237832962, 45.00837734365422, 53.213486448733924, 55.88713227891721, 52.94681233890141, 43.147178848117505, 45.49724309776791, 41.196248974651894, 33.12460885450589, 18.439379962218023, 14.69037446850126, 22.5552807337765, 26.461317988701445, 35.66067371768539, 52.00815652210222, 79.10276911434836, 99.29847064125187, 107.71543503981832, 102.10613016064984, 99.05957002842155, 93.95447338015394, 94.42402265125482, 90.12969833515311, 72.78073156806374, 60.18910333508381, 72.33605479119439, 86.98240260427556, 89.11210555418849, 98.25259202708571, 112.58408809219378, 115.45253141007427, 106.28438539588706, 104.83285648948457, 105.2715967327536, 98.32221140682027, 98.34063269783302, 105.23590567151513, 124.85035312818088, 126.67213272850825, 133.39117585357647, 134.96074272195395, 138.75029242568297, 136.66301574322554, 127.95569394467502, 117.1591951528972, 116.79411395070001, 68.95990517689609, 205.77174236290088, 206.2583641189175, 208.50869111557395, 198.90147812087076, 195.71898579248878, 193.24155649583966, 190.1721031274661, 227.82141145965522, 111.79336768954875, 42.64925188543429, 49.79309084280215, 58.0769134980834, 53.088262797976526, 45.62437056283191, 58.404256916365696, 73.70216307528986, 65.3361394450221, 62.48231383348207, 64.34254663276346, 76.5919363125213, 78.24554236948158, 76.7846971490093, 71.10825290922128, 58.97266046795171, 32.96437311249273, 22.341721665239064, 37.22758167906895, 38.08701628763954, 37.92814648312228, 41.64684475589537, 50.311042794149664, 66.36149142376517, 74.19919591410356, 72.17743201344864, 60.40449098596727, 50.8919111740957, 37.798715790674024, 36.97008917553955, 45.99254151044821, 57.6010456951293, 65.66418311896278, 70.6640914829021, 71.7028449846522, 82.38959056713396, 95.625132782506, 97.53190949648652, 86.43440776008441, 70.39805981019134, 57.95618629755805, 42.76802239484375, 39.197365052176366, 62.73877308949851, 159.97935450769302, 207.9807506939108, 229.04791508846273, 230.38916984046725, 224.351722053784, 223.0757120008753, 217.45410107890132, 202.95336334555557, 99.27090296279032, 48.36364912026864, 44.21060649015778, 54.75015538674364, 55.477727897375075, 68.16302016728356, 90.44790958247468, 102.07971959576211, 118.77924564516573, 128.09966417839274, 126.42609507287608, 119.04462412325476, 123.5676578427172, 137.1695572710969, 144.35713345909718, 148.148075068438, 145.34125096541217, 141.23343305034876, 133.68153273159405, 123.88443192898842, 113.28721577671277, 107.16755149380988, 106.60048159338507, 97.81392981927657, 88.63689440600811, 78.80821220817992, 62.59482829804664, 63.49632091087767, 70.70933011309172, 84.20530356203834, 95.87114640639622, 97.31106733696667, 87.24449470408902, 80.67341560779964, 74.33197848731274, 75.00861070610875, 78.26791043238165, 79.37654828082204, 74.58878706568443, 70.8626578335088, 72.60870321116776, 72.56597163225888, 66.22946876533565, 59.08130195547327, 52.90717871151225, 48.951375272558714, 78.9118565503828, 102.01548515106595, 101.63543032774214, 94.11310954537014, 86.6575822540816, 83.80124168817271, 21.045471876928342, 16.862109413168128, 11.862008844337769, 7.816077060625374, 4.421905536648138, 15.055271948492695, 21.521082829417264, 23.146418597828227, 22.198874710670434, 21.933570672817748, 17.881316873402305, 15.111696330671155, 11.526835225534837, 8.667774678959125, 7.2308170902341296, 7.364208704366447, 9.033639686596565, 8.672577911932674, 10.330203231036084, 10.354597869542948, 8.237023273808694, 6.826296472539967, 9.85861539164022, 9.879232781972544, 10.717054392625927, 11.811092283020841, 10.926707380205094, 10.053503636431104, 7.767851386045273, 8.476551119411702, 10.879901862763418, 10.08761832606609, 8.501249219555982, 8.48785936972938, 12.870028624307075, 17.025818548979313, 13.871065961514764, 9.265747330349924, 8.852686802231092, 7.221210432956407, 5.915928900047429, 6.74635689525047, 7.242704813559252, 9.04147091271833, 13.648279775515784, 18.0285766208104, 31.614422813938937, 32.11723206127736, 30.0830501521216, 31.700418862158575, 35.49727301170932, 36.3985601695042, 36.03310602453939, 19.48778699080235, 19.262316525901955, 13.45264254598426, 11.86061200255344, 19.446054513632998, 21.922919175091554, 26.368260516815035, 32.07340785656521, 37.10109520856252, 40.82478339587259, 39.23252304914928, 38.832263347779055, 42.00604635522077, 40.97324289688461, 33.60678567818762, 24.494973359627753, 20.641160519032685, 23.89210023876713, 28.161940292509083, 23.94705138144371, 15.627790753847348, 15.089274650398734, 23.005009674222954, 24.58506496518962, 22.385336798807426, 22.976092853563916, 24.15530044361807, 28.903444340722327, 31.61326172688223, 29.037650553052824, 27.12233085617189, 29.864641175664687, 31.048339211795586, 32.3505668930288, 32.428406448324985, 26.61295362448876, 19.570998930444944, 12.926773780189514, 5.181321119278079, 11.706271486353137, 15.128027732320113, 15.444876154726154, 18.957170537070485, 22.14727027009145, 32.498355210108635, 31.0098413622269, 14.890148491212917, 11.018183577327509, 9.311192613583778, 10.882455099593018, 8.989201832464996, 10.389296156147022, 7.867898282163329, 9.595529653277891, 4.518367531745376, 5.268761998645412, 8.799120038230415, 14.841220723533612, 18.143344509879196, 19.197544258192494, 16.004958841247312, 13.285527008705028, 16.95983539620845, 18.770435825128374, 18.32150802262316, 15.670913728586198, 11.430398596811349, 8.521440912474011, 10.594461932844402, 11.26872249056318, 13.030346624435783, 14.526917420658423, 15.369415680673132, 11.464752886478994, 11.46093145016298, 14.177032766729237, 14.352702032350939, 14.105791150399044, 12.737767932465724, 14.432209601019043, 12.915959516949682, 10.113111208163415, 5.25859920142932, 0.923479312681776, 7.170849256595689, 11.49854521575997, 12.283454709899756, 11.899966415779907, 9.043094548302506, 5.614379451826564, 4.364850524100354, 2.9360612385577056, 3.0652597105511834, 5.892235903863485, 7.660038490449858, 10.391940392945838, 12.182121464182668, 11.809489450329348, 14.843982418238593, 22.715504853574647, 20.382213037867906, 19.95246056805638, 18.68853601953921, 15.231816250240989, 12.167525099347111, 13.748251244881674, 15.505911580156862, 2.690204292124871, 4.834694310681906, 5.400643083608887, 3.9606013006530127, 1.5867180058110237, 0.635531142760442, 1.5930208970762603, 1.349679950879736, 0.8292817828030848, 2.2044886928908802, 3.7039422643754176, 3.4416390274088644, 1.8823989397199237, 1.0872149371122517, 0.7478991511590316, 1.8070573781850174, 1.3063370540379784, 0.9760823501225155, 0.655205364771882, 1.7593635763830167, 2.3164579167069554, 3.450014412662141, 4.9795237175274485, 6.171596707849991, 6.39688358084653, 6.83348794817584, 6.390642921718752, 6.1156900945648145, 5.883801939509293, 6.058935676540596, 5.001903707752152, 3.787083103774918, 4.985691139625094, 6.352401649594751, 7.025635740697963, 6.486379689359916, 4.490161292802049, 3.734675454624027, 4.103225209573541, 3.3691746183405447, 3.6479146564279286, 4.01923255232219, 3.330884917378526, 2.41819954424575, 3.3692121123285457, 5.612670691122344, 4.80330247041136, 8.328536398290602, 8.951768504444312, 8.513700401300586, 8.845983851645972, 9.699782405654478, 8.071574696885664, 2.2334486722719054, 0.7990589887447909, 0.9356991235651672, 1.610452069036245, 2.5088512661987625, 2.49745418625398, 2.3053370965629965, 2.1681122884285777, 2.0714783368940073, 1.447936633915515, 0.8277409207480949, 0.6687632140964795, 0.8159516616131774, 2.0180192834124697, 3.05189021151391, 3.134069643942034, 2.6651605984878866, 1.7298513454485913, 1.7526691164114583, 1.686206378155911, 1.4574471291669249, 1.3566955618746417, 1.3048196250904975, 0.9772391673104814, 0.756736948127597, 1.2451890195259194, 1.1818160926355334, 1.138219120146564, 1.8510056748497725, 1.9375600135084792, 1.8261202753126222, 1.4777987825465897, 0.7246289900733069, 0.6152035834486087, 1.1720967267866373, 1.4851547338690907, 1.5411512961949931, 1.0409488435282335, 0.5130612037660889, 0.33713839472922685, 0.2606584594278834, 0.22704743195498178, 0.31322275336766126, 0.43645084067066836, 0.31621688347314336, 3.750058375544568, 11.058376209466616, 10.801298589147397, 12.798160809107474, 13.567341262386496, 13.387385401890814, 12.62954470653729, 8.084981042022035, 3.607722816854125, 3.55838431851464, 3.7492105819576897, 4.545784288509012, 4.742722575850165, 4.73488595201126, 4.274794377973302, 3.644064068448441, 101.24228365658294, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
			peaks: [32.815745299535706, 83.60321993396775]
		};
	}

	ngAfterViewInit() {
		this.ctx = (this.canvas.nativeElement as HTMLCanvasElement).getContext('2d');
		this.ctx.canvas.width = this.width;
		this.ctx.canvas.height = this.height;

		let axis = d3.select('#axis')
			.attr('position', 'absolute')
			.attr('width', 30)
			.attr('height', 2048)
			.attr('z-index', 2);
		let axisScale = d3.scaleLinear().domain([-8.49, 263.65]).range([2048, 0]);
		let y_axis = d3.axisLeft(axisScale);
		axis.append('g').attr('transform', 'translate(27, 0)').style('font-size', '11px').call(y_axis);

		this.avmuService.radarData.subscribe((next) => {
			this.radarData = next;
			// this.drawCanvas();
		});
		// this.drawCanvas();
	}

	drawCanvas() {
		this.radarData.magnitude.forEach((item, index) => {
			this.ctx.fillStyle = d3.interpolateBlues(item / 100);
			this.ctx.fillRect(0, this.height - index, this.width, 1);
		});
	}

}
